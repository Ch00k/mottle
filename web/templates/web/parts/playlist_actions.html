<div>
    {% if playlist.owner_id == request.session.spotify_user_spotify_id %}
        {% if source == "playlists_my" %}
            <a href=""
               hx-get="{% url 'rename_playlist' playlist.id %}"
               hx-target="previous .name"
               hx-headers='{% include "web/parts/playlist_metadata_headers.html" %}'>
                {% include "web/icons/edit.html" with title="Rename" %}
            </a>
        {% endif %}
        <a href=""
           hx-get="{% url 'playlist_cover_image' playlist.id %}"
           hx-target="body"
           hx-swap="beforeend"
           hx-indicator="#spinner"
           hx-headers='{% include "web/parts/playlist_metadata_headers.html" %}'>
            {% include "web/icons/image.html" with title="Cover image" %}
        </a>
    {% endif %}
    <a href="{% url 'deduplicate_playlist' playlist.id %}"
       hx-boost="true"
       hx-indicator="#spinner"
       hx-headers='{% include "web/parts/playlist_metadata_headers.html" %}'>
        {% include "web/icons/find_duplicates.html" %}
    </a>
    <a href=""
       hx-get="{% url 'merge_playlist' playlist.id %}"
       hx-target="body"
       hx-swap="beforeend"
       hx-indicator="#spinner"
       hx-headers='{% include "web/parts/playlist_metadata_headers.html" %}'>{% include "web/icons/merge.html" %}</a>
    <a href=""
       hx-get="{% url 'watch_playlist' playlist.id %}"
       hx-target="body"
       hx-swap="beforeend"
       hx-indicator="#spinner"
       hx-headers='{% include "web/parts/playlist_metadata_headers.html" %}'>{% include "web/icons/watch.html" %}</a>
    {% if playlist.id in watching_playlists %}
        <a href=""
           hx-get="{% url 'configure_playlist' playlist.id %}"
           hx-target="body"
           hx-swap="beforeend"
           hx-indicator="#spinner"
           hx-headers='{% include "web/parts/playlist_metadata_headers.html" %}'>
            {% include "web/icons/settings.html" %}
        </a>
        <a href="{% url 'playlist_updates' playlist.id %}"
           hx-boost="true"
           hx-indicator="#spinner"
           hx-headers='{% include "web/parts/playlist_metadata_headers.html" %}'>
            {% include "web/icons/update.html" with title="Check for updates" %}
        </a>
    {% endif %}
    {% if source == "playlists_my" %}
        {% if playlist.owner_id == request.session.spotify_user_spotify_id %}
            {% include "web/parts/playlist_delete.html" %}
        {% else %}
            {% include "web/parts/playlist_unfollow.html" %}
        {% endif %}
    {% elif source == "playlists_search" %}
        {% if playlist.id in user_playlist_ids %}
            {% include "web/parts/playlist_unfollow.html" %}
        {% else %}
            {% include "web/parts/playlist_follow.html" %}
        {% endif %}
    {% elif source == "playlist" %}
        {% if playlist.owner_id == request.session.spotify_user_spotify_id %}
            {% include "web/parts/playlist_delete.html" with target="this" %}
        {% else %}
            {% if playlist.id in user_playlist_ids %}
                {% include "web/parts/playlist_unfollow.html" %}
            {% else %}
                {% include "web/parts/playlist_follow.html" %}
            {% endif %}
        {% endif %}
    {% else %}
    {% endif %}
</div>
